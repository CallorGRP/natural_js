<article id="communicator">
	<div class="demoBox">
		<h4>1) Get json data from server(html/apid/data/grid.json)</h4>

		<div class="btnBox" align="center">
			<a id="btnGetJson" href="#" data-opts='{ "color": "skyblue", "size": "large" }'>Submit</a>
		</div>

		<p class="smallContTit">Result : </p>
		<pre style="height: 100px;overflow: auto;"><code id="jsonResult"></code></pre>

		<br />
		<h4>2) Get html page(View & Controller) from server()</h4>

		<p class="smallContTit">Default options : </p>
		<table class="form" style="width: 100%;">
			<tr>
				<th width="10%" align="right">context</th>
				<td width="40%"><input id="context" type="text" value="div.result:eq(1)" readonly="readonly" /> Target context</td>
				<th width="10%" align="right">url</th>
				<td width="40%"><input id="url" type="text" value="html/apid/datepicker.html" /> Target url</td>
			</tr>
			<tr>
				<th align="right">async</th>
				<td><input id="async" type="checkbox" checked="checked" /> If this checkbox with uncheck(false), ajax request with synchronization method</td>
				<th align="right">type</th>
				<td width="40%"><input id="type" type="text" value="POST" /> Request method</td>
			</tr>
			<tr>
				<th align="right">effect<br />[effect, duration, callback]</th>
				<td colspan="3">[ <input id="effect" type="text" value="fadeIn" style="width: 50px;" />,
					<input id="duration" type="text" value="300" style="width: 50px;" />,
					<textarea id="callback" rows="3" cols="30">
function() {
	N.log("Effect end");
}
					</textarea> ]
					 * effects : show, hide, slideUp, slideDown, fadeIn, fadeOut
				</td>
			</tr>
		</table>

		<p class="smallContTit">Method options : </p>
		<table class="form" style="width: 100%;">
			<tr>
				<th align="right" width="10%">submit</th>
				<th align="right" width="10%">arguments[0]</th>
				<td width="80%" colspan="3"><textarea id="jsonCallback" rows="3" cols="60">
function(data) {
	N("#jsonResult", view).text(JSON.stringify(data));
}
				</textarea><br /> Success callback function</td>
			</tr>
			<tr>
				<th align="right" width="10%">request</th>
				<th align="right" width="10%">arguments[0]</th>
				<td width="80%" colspan="3"><textarea id="request" rows="2" cols="60">Hello datepicker~!</textarea><br /> Request attribute</td>
			</tr>
		</table>

		<div class="btnBox" align="center">
			<a id="btnGetPage" href="#" data-opts='{ "color": "skyblue", "size": "large" }'>Submit</a>
		</div>

		<p class="smallContTit">Result : </p>
		<div class="result" style="height: 552px;"></div>

		<p class="smallContTit">Source Code :</p>
		<pre><code id="sourceCode"></code></pre>
	</div>
</article>

<script type="text/javascript">

N("article#communicator").cont({
    init : function(view, request) {
    	// source Code
    	N.comm({
       		url : "html/apid/" + view.attr("id") + ".html",
       		dataType : "html"
       	}).submit(function(html) {
       		$("#sourceCode", view).text(html);
       	});

    	// initialize buttons in div.btnBox
    	N("div.btnBox a", view).button();

    	// bind events
    	this.setEvents(view, this);
    },
    setEvents : function(view, this_) {
    	N("a#btnGetJson", view).click(function(e) {
            e.preventDefault();
            N.comm({
        		url : "html/apid/data/grid.json"
        	}).submit(N.browser.msieVersion() !== 8 ? eval("(" + N("textarea#jsonCallback", view).val() + ")") : function(data) {
        		N("#jsonResult", view).text(JSON.stringify(data));
        	});
        });

    	N("a#btnGetPage", view).click(function(e) {
            e.preventDefault();
            var opts = {
            	url : N("input#url", view).val(),
            	async : N("input#async", view).is(":checked"),
            	type : N("input#type", view).val(),
        		effect : N.string.trimToNull(N("input#effect", view).val()) === null ? false :
      				[N("input#effect", view).val(),
      		        parseInt(N("input#duration", view).val()),
      		        N.string.trimToNull(N("textarea#callback", view).val()) !== null ?
						eval("(" + N("textarea#callback", view).val() + ")") : undefined ]
            }
            N(N("input#context", view).val(), view).comm(opts).request.attr("hello", N("textarea#request", view).val()).submit();
        });
    }
});

</script>