<div id="form">
	<div class="intro">
		<h1><b>Form</b> : Form(N.form)은 지정한 영역에 Row 데이터를 바인드하고 연결 해 폼을 만듭니다.</h1>
		<h2>[Initialize form] 버튼을 클릭하면 지정한 데이터와 영역을 기반으로 폼 객체를 생성 합니다.</h2>
		<h2>[add] 버튼을 클릭하면 폼 안에 있는 입력요소(HTML Input element)를 기반으로 새로운 data 를 생성하고 생성된 data 를 바인드 합니다.</h2>
		<h2>[bind] 버튼을 클릭하면 DATA 영역에 있는 JSON 데이터를 지정한 요소에 폼을 바인드 합니다.</h2>
		<h2>[revert] 버튼을 클릭하면 처음 바인드 한 상태로 돌려 줍니다.</h2>
		<h2>[val] 버튼을 클릭하면 key 만 함수의 인자로 입력하면 해당 값을 가져오고 key, val 을 지정하면 마지막 인자값인 val 값으로 값을 바꿔줍니다.</h2>
		<h2>[data] 버튼을 클릭하면 Form에 바인드되어 있는 데이터를 가져옵니다. 인자로 true를 지정하면 현제 선택되어 있는 data만 가져옵니다.</h2>
		<h2>[validate] 버튼을 클릭하면 폼 안에 입력된 값 전체에 대한 데이터 검증을 실행하고 성공하면 true 를 반환하고 실해하면 false 와 검증오류 메시지를 보여줍니다.</h2>
		<h2>Form은 한번만 초기화 할 수 있습니다. 옵션을 변경하려면 [Reload this page] 버튼을 누른 후 다시 설정 하기 바랍니다.</h2>
	</div>
	<div class="divBar">DATA</div>
	<div class="dataBox">
		<textarea id="data" class="data">
[
	{
	    "_id": "53e21cba9f982281b3459438",
	    "index": 0,
	    "guid": "1a9e5450-c664-4bfd-8174-d03005eca08d",
	    "isActive": "Y",
	    "balance": "1284.38",
	    "picture": "http://placehold.it/32x32",
	    "age": 26,
	    "eyeColor": "green",
	    "name": "Dean Stanley",
	    "gender": "male",
	    "company": ["ASSISTIX", "CANDECOR"],
	    "email": "deanstanley@zentia.com",
	    "phone": "+1 (920) 409-2680",
	    "address": "936 Meserole Street, Vicksburg, Massachusetts, 1198",
	    "about": "Mollit elit qui reprehenderit fugiat excepteur adipisicing sunt id proident laborum sint proident.\r\nAmet cupidatat ipsum do irure qui magna sunt pariatur commodo eiusmod ipsum qui ad culpa.",
	    "registered": "2014-07-27T03:58:09 -09:00",
	    "registered2": "2014-11-10T03:58:09 -09:00",
	    "latitude": 81.131606,
	    "longitude": 87.110498,
	    "greeting": "<font color='red'>Hello, Dean Stanley! You have 1 unread messages.</font>",
	    "favoriteFruit": ["strawberry", "banana"]
	},
	{
	    "_id": "53e21cba47868d69889d7910",
	    "index": 1,
	    "guid": "9b855e26-2903-4b9a-b04a-e96544db2543",
	    "isActive": "N",
	    "balance": "1461.27",
	    "picture": "http://placehold.it/32x32",
	    "age": 31,
	    "eyeColor": "brown",
	    "name": "Howard Kramer",
	    "gender": "female",
	    "company": "CANDECOR",
	    "email": "howardkramer@assistix.com",
	    "phone": "+1 (806) 435-3679",
	    "address": "173 Harwood Place, Yonah, Guam, 8467",
	    "about": "Nisi velit eu non in dolor in. Qui aliquip sunt sit ut reprehenderit exercitation deserunt do. Sit voluptate officia qui fugiat qui dolor exercitation proident. Deserunt aliqua eiusmod eu magna dolor nostrud adipisicing excepteur.\r\n",
	    "registered": "2014-03-24T22:55:08 -09:00",
	    "latitude": -80.020226,
	    "longitude": -153.640872,
	    "greeting": "Hello, Howard Kramer! You have 9 unread messages.",
	    "favoriteFruit": ["apple", "strawberry"]
	},
    {
        "gender": [{
	        	"key" : "male",
	        	"val" : "male"
	        },{
	        	"key" : "female",
	        	"val" : "female"
        }],
        "eyeColor": [{
	        	"key" : "blue",
	        	"val" : "blue"
	        },{
	        	"key" : "brown",
	        	"val" : "brown"
	        },{
	        	"key" : "green",
	        	"val" : "green"
        }],
        "company": [{
	        	"key" : "PROSELY",
	        	"val" : "PROSELY"
	        },{
	        	"key" : "ASSISTIX",
	        	"val" : "ASSISTIX"
	        },{
	        	"key" : "VORATAK",
	        	"val" : "VORATAK"
	        },{
	        	"key" : "CANDECOR",
	        	"val" : "CANDECOR"
	        },{
	        	"key" : "BARKARAMA",
	        	"val" : "BARKARAMA"
	        },{
	        	"key" : "STOCKPOST",
	        	"val" : "STOCKPOST"
	        },{
	        	"key" : "MICROLUXE",
	        	"val" : "MICROLUXE"
	        },{
	        	"key" : "SHADEASE",
	        	"val" : "SHADEASE"
	        },{
	        	"key" : "ZENTIA",
	        	"val" : "ZENTIA"
        	},{
	        	"key" : "INTRADISK",
	        	"val" : "INTRADISK"
        }],
        "favoriteFruit": [{
	        	"key" : "apple",
	        	"val" : "apple"
	        },{
	        	"key" : "strawberry",
	        	"val" : "strawberry"
	        },{
	        	"key" : "banana",
	        	"val" : "banana"
        }]
    }
]
		</textarea>
	</div>
	<div class="divBar">DEMO</div>
	<div class="demoBox">
		<p>Default options : </p>
		<table class="form" style="width: 100%;">
			<tr>
				<th width="10%" align="right">context</th>
				<td width="40%"><input id="context" type="text" value="table#form" readonly="readonly" /> Target element</td>
				<th width="10%" align="right">validate</th>
				<td width="40%"><input id="validate" type="checkbox" checked="checked" /> If uncheck(false) this checkbox, disable realtime validation check</td>
			</tr>
			<tr>
				<th align="right">html</th>
				<td colspan="3"><input id="html" type="checkbox" /> If check(true) this checkbox, don't recognize HTML tags</td>
			</tr>
		</table>

		<p>Method options : </p>
		<table class="form" style="width: 100%;">
			<tr>
				<th align="right" width="10%">bind</th>
				<th align="right" width="10%">arguments[0]</th>
				<td width="80%" colspan="3">
					<input id="row" type="text" value="0" /> Row index for bind(default : 0)
				</td>
			</tr>
			<tr>
				<th align="right" width="10%" rowspan="2">val</th>
				<th align="right" width="10%">arguments[0]</th>
				<td width="80%" colspan="3">
					<input id="key" type="text" value="name" /> key name
				</td>
			</tr>
			<tr>
				<th align="right" width="10%">arguments[1]</th>
				<td width="80%" colspan="3">
					<input id="val" type="text" value="jeff beck" /> If set empty value, get key value
				</td>
			</tr>
			<tr>
				<th align="right" width="10%">data</th>
				<th align="right" width="10%">arguments[0]</th>
				<td width="80%" colspan="3">
					<input id="data" type="checkbox" checked="checked" /> If uncheck(false) this checkbox, get all data
				</td>
			</tr>
		</table>

		<div align="center" class="btnBox">
			<a id="btnInit" href="#" class='{ "color": "gray", "size": "large" }'>Initialize form</a> |
			<a id="btnAdd" href="#" class='{ "color": "skyblue", "size": "large", "disable": true }'>add</a> | or |
			<a id="btnBind" href="#" class='{ "color": "skyblue", "size": "large", "disable": true }'>bind</a>
			<a id="btnRevert" href="#" class='{ "color": "skyblue", "size": "large", "disable": true }'>revert</a> |
			<a id="btnVal" href="#" class='{ "color": "skyblue", "size": "large", "disable": true }'>val</a>
			<a id="btnData" href="#" class='{ "color": "skyblue", "size": "large", "disable": true }'>data</a>
			<a id="btnValidate" href="#" class='{ "color": "skyblue", "size": "large", "disable": true }'>validate</a>
			<a id="btnReload" href="#" class='{ "color": "white", "size": "large" }'>Reload this page</a>
		</div>

		<p>Result : </p>
		<div class="result" align="center" style="height: 720px; padding: 15px;">
			<table id="form" class='form'>
				<tr height="43">
					<th width="85" align="right"><label for="picture">picture</label></th>
					<td width="*"><img id="picture" /></td>
				</tr>
				<tr>
					<th align="right"><label for="name">name</label></th>
					<td>
						<input id="name" type="text" class='{ "validate" : [["required"]] }' />
					</td>
				</tr>
				<tr>
					<th align="right"><label for="email">email</label></th>
					<td>
						<input id="email" type="text" class='{ "format" : [["trimtoempty"], ["generic", "@@@@@@＊＊＊"]], "validate" : [["required"], ["email"]] }' />
					</td>
				</tr>
				<tr>
					<th align="right"><label for="_id">password</label></th>
					<td>
						<input id="_id" type="password" class='{ "validate" : [["required"]] }' />
					</td>
				</tr>
				<tr>
					<th align="right"><label for="balance">balance</label></th>
					<td>
						<input id="balance" type="text" class='{ "format" : [["trimtoempty"], ["numeric", "$#,###.##0"]], "validate" : [["required"], ["decimal"]] }' />
					</td>
				</tr>
				<tr>
					<th align="right"><label for="phone">phone</label></th>
					<td>
						<input id="phone" type="text" readonly="readonly" />
					</td>
				</tr>
				<tr>
					<th align="right"><label for="age">age</label></th>
					<td>
						<input id="age" type="text" disabled="disabled" />
						<input id="index" type="hidden" />
					</td>
				</tr>
				<tr>
					<th align="right"><label for="eyeColor">eye color</label></th>
					<td>
						<select id="eyeColor" class='{ "validate" : [["required"]] }'>
							<option>선택</option>
						</select>
					</td>
				</tr>
				<tr>
					<th align="right"><label for="company">company</label></th>
					<td>
						<select id="company" multiple="multiple"></select>
					</td>
				</tr>
				<tr>
					<th align="right"><label for="gender">gender</label></th>
					<td>
						<input id="gender" type="radio" />
					</td>
				</tr>
				<tr>
					<th align="right"><label for="favoriteFruit">favorite fruit</label></th>
					<td>
						<input id="favoriteFruit" type="checkbox" />
					</td>
				</tr>
				<tr>
					<th align="right"><label for="registered">registered</label></th>
					<td>
						<input id="registered" type="text" class='{ "format": [["date", 8, "date"]], "validate" : [["required"]] }' />
					</td>
				</tr>
				<tr>
					<th align="right"><label for="registered2">registered m</label></th>
					<td>
						<input id="registered2" type="text" class='{ "format": [["date", 6, "month"]], "validate" : [["required"]] }' />
					</td>
				</tr>
				<tr>
					<th align="right"><label for="about">about</label></th>
					<td>
						<textarea id="about" rows="5" cols="80" class='{ "format" : [["trimtoempty"], ["limit", "50", "..."]], "validate" : [["required"], ["korean"]] }'></textarea>
					</td>
				</tr>
				<tr>
					<th align="right"><label for="greeting">about</label></th>
					<td id="greeting"></td>
				</tr>
				<tr>
					<th align="right"><label for="isActive">isActive</label></th>
					<td>
						<input id="isActive" type="checkbox" />
					</td>
				</tr>
			</table>
		</div>
	</div>

	<div class="divBar">SOURCE CODE</div>
	<div class="sourceBox">Omitted</div>
</div>

<script type="text/javascript">

N("div#form").sc({
    init : function(view, request) {
    	// put source code
    	IndexServiceController.getSourceCode(request.get("url"), N("div.sourceBox"));

    	// make button
    	this.initButton(view);

    	// data
    	var data = eval(N("textarea.data").val());

    	// create selects
    	this.createSelects(data);

    	// event bind
    	this.setEvents(view, this, data)
    },
    createSelects : function(data) {
    	$(data[2].eyeColor).select("select#eyeColor").bind();
		$(data[2].company).select("select#company").bind();
		$(data[2].gender).select("input#gender").bind();
		$(data[2].favoriteFruit).select("input#favoriteFruit").bind();
    },
    initButton : function(view) {
    	N("div.btnBox", view).button();
    },
    setEvents : function(view, this_, data) {
    	var form;
    	N("a#btnInit", view).click(function(e) {
    		e.preventDefault();

    		var opts = {
    			context : N("input#context", view).val(),
    			validate : N("input#validate", view).is(":checked"),
    			html : N("input#html", view).is(":checked")
    		}

    		form = N(data).form(opts);

    		N("div.btnBox", view).find("a").instance("button", function() {
    			if(this.context().is("a#btnInit") || this.context().is("a#btnRevert")) {
    				this.disable();
    			} else {
	            	this.enable();
    			}
            });
    	});

        N("a#btnBind", view).click(function(e) {
            e.preventDefault();
            form.bind(parseInt($("input#row").val()));

            N("a#btnAdd", view).instance("button").disable();
            N("a#btnRevert", view).instance("button").enable();
        });

        N("a#btnAdd", view).click(function(e) {
            e.preventDefault();
            form.add();

            N("a#btnBind", view).instance("button").disable();
        });

        N("a#btnRevert", view).click(function(e) {
            e.preventDefault();
            form.revert();
        });

        N("a#btnVal", view).click(function(e) {
            e.preventDefault();
            var key = N.string.trimToNull(N("input#key", view).val());
            var value = N.string.trimToNull(N("input#val", view).val());
        	if(value !== null) {
        		form.val(key, value);
        	} else {
        		N("div.result").alert(form.val(key)).show();
        	}
        });

        N("a#btnData", view).click(function(e) {
        	e.preventDefault();
        	N("div.result").alert({
        		msg : '<div class="pre">' + N.json.format(form.data(N("input#data", view).is(":checked"))) + '</div>',
        		width : 400,
        		height : 250
        	}).show();
        });

        N("a#btnValidate", view).click(function(e) {
            e.preventDefault();
            N("table#form").alert('<b>전체검증 결과 : ' + form.validate() + '</b>').show()
        });
        
        N("a#btnReload", view).click(function(e) {
        	e.preventDefault();
        	N(view.parent()).comm(this_.request.get("url")).submit();
        });
    },
    /**
     * for tab onOpen exemple
     */
    onOpen : function(onOpenData) {
    	N.log("onOpen 콜백 실행\nonOpenData :\n" + JSON.stringify(onOpenData));
    }
});

</script>