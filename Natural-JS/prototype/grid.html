<div id="gridEx">
	<div class="intro">
		<h1><b>Grid</b> : Grid(N.grid)은 지정한 테이블 요소(HTML Table element)에 List 데이터를 바인드하고 연결 해 그리드를 만들어 줍니다.</h1>
		<h2>[Initialize tab] 버튼을 클릭하면 지정한 데이터와 테이블 요소를 기반으로 그리드 객체를 생성 합니다.</h2>
		<h2>[add] 버튼을 클릭하면 그리드 안에 있는 입력요소를 기반으로 새로운 data 를 생성하고 생성된 data 를 바인드 합니다.</h2>
		<h2>[bind] 버튼을 클릭하면 /Natural-JS/prototype/data/grid.json 파일을 Communicator로 불러와 그리드에 바인드 합니다.</h2>
		<h2>[revert] 버튼을 클릭하면 처음 바인드 한 상태로 돌려 줍니다. 특정 row 를 지정할 수 있습니다.</h2>
		<h2>[remove] 버튼을 클릭하면 지정한 row가 삭제 됩니다.</h2>
		<h2>[val] 버튼을 클릭하면 row 와 key 만 함수의 인자로 입력하면 해당 값을 가져오고 row, key, val 을 지정하면 마지막 인자값인 val 값으로 값을 바꿔줍니다.</h2>
		<h2>[data] 버튼을 클릭하면 Grid에 바인드되어 있는 데이터를 가져옵니다. 인자로 row의 상태를 지정하면 현제 선택되어 있는 해당상태의 row만 가져옵니다.</h2>
		<h2>[validate] 버튼을 클릭하면 그리드 안에 입력된 값 전체에 대한 데이터 검증을 실행하고 성공하면 true 를 반환하고 실해하면 false 와 검증오류 메시지를 보여줍니다.</h2>
		<h2>Grid은 한번만 초기화 할 수 있습니다. 옵션을 변경하려면 [Reload this page] 버튼을 누른 후 다시 설정 하기 바랍니다.</h2>
	</div>
	<div class="divBar">DATA</div>
	<div class="dataBox">
		/Natural-JS/prototype/data/grid.json
	</div>
	<div class="divBar">DEMO</div>
	<div class="demoBox">
		<p>Default options : </p>
		<table class="form" style="width: 100%;">
			<tr>
				<th width="10%" align="right">context</th>
				<td width="40%"><input id="context" type="text" value="table#grid" readonly="readonly" /> Target element</td>
				<th width="10%" align="right">height</th>
				<td width="40%" style="background-color: #efffff;"><input id="height" type="text" value="395" /> </td>
			</tr>
			<tr>
				<th align="right">validate</th>
				<td><input id="validate" type="checkbox" checked="checked" /> If uncheck(false) this checkbox, disable realtime validation check</td>
				<th align="right">html</th>
				<td><input id="html" type="checkbox" /> If check(true) this checkbox, don't recognize HTML tags</td>
			</tr>
			<tr>
				<th align="right">addTop</th>
				<td><input id="addTop" type="checkbox" /> If check(true) this checkbox, create top to new row by add method
					<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">* If height is great then 0, addTop options always set true</font>
				</td>
				<th align="right">resizable</th>
				<td><input id="resizable" type="checkbox" /> </td>
			</tr>
			<tr>
				<th align="right">vResizable</th>
				<td style="background-color: #efffff;"><input id="vResizable" type="checkbox" /> </td>
				<th align="right">sortable</th>
				<td><input id="sortable" type="checkbox" /> </td>
			</tr>
			<tr>
				<th align="right">select</th>
				<td><input id="select" type="checkbox" /> </td>
				<th align="right">multiselect</th>
				<td><input id="multiselect" type="checkbox" /> </td>
			</tr>
			<tr>
				<th align="right">hover</th>
				<td><input id="hover" type="checkbox" /> </td>
				<th align="right">createRowDelay</th>
				<td><input id="createRowDelay" type="text" value="1" /> </td>
			</tr>
			<tr>
				<th align="right">scrollPaging.size</th>
				<td><input id="scrollPagingSize" type="text" value="100" /> </td>
				<th align="right">rowHandler</th>
				<td><textarea id="rowHandler" rows="5" cols="60">
function(index, row, data) {
	N.log(index);
	N.log(row);
	N.log(data);
}
				</textarea><br /> Callback function for tab active event</td>
			</tr>
			<tr>
				<th align="right">onSelect</th>
				<td><textarea id="onSelect" rows="5" cols="60">
function(index, row, data) {
	N.log(index);
	N.log(row);
	N.log(data);
}
				</textarea><br /> Callback function for tab active event</td>
				<th align="right">onBind</th>
				<td><textarea id="onBind" rows="4" cols="60">
function(context, data) {
	N.log(context);
	N.log(data);
}
				</textarea><br /> Callback function for tab active event</td>
			</tr>
		</table>

		<p>Method options : </p>
		<table class="form" style="width: 100%;">
			<tr>
				<th align="right" width="10%" rowspan="3">val</th>
				<th align="right" width="10%">arguments[0]</th>
				<td width="80%" colspan="3">
					<input id="row" type="text" value="0" /> Target row
				</td>
			</tr>
			<tr>
				<th align="right" width="10%">arguments[1]</th>
				<td width="80%" colspan="3">
					<input id="key" type="text" value="company" /> Target key name
				</td>
			</tr>
			<tr>
				<th align="right" width="10%">arguments[2]</th>
				<td width="80%" colspan="3">
					<input id="val" type="text" value="NATURAL COMPANY" /> If set empty value, get key value
				</td>
			</tr>
			<tr>
				<th align="right" width="10%">data</th>
				<th align="right" width="10%">arguments[0]</th>
				<td width="80%" colspan="3">
					<select id="data">
						<option value="modified">modified</option>
						<option value="insert">insert</option>
						<option value="update">update</option>
						<option value="delete">delete</option>
					</select> row status
				</td>
			</tr>
			<tr>
				<th align="right" width="10%">revert</th>
				<th align="right" width="10%">arguments[0]</th>
				<td width="80%" colspan="3">
					<input id="rvtRow" type="text" value="0" /> Revert row index, if set empty value, revert all row data
				</td>
			</tr>
			<tr>
				<th align="right" width="10%">remove</th>
				<th align="right" width="10%">arguments[0]</th>
				<td width="80%" colspan="3">
					<input id="rmvRow" type="text" value="0" /> Remove row index
				</td>
			</tr>
		</table>

		<div align="center" class="btnBox">
			<a id="btnInit" href="#" class='{ "color": "gray", "size": "large" }'>Initialize grid</a>
			<a id="btnAdd" href="#" class='{ "color": "skyblue", "size": "large", "disable": true }'>add</a>
			<a id="btnBind" href="#" class='{ "color": "skyblue", "size": "large", "disable": true }'>bind</a>
			<a id="btnRevert" href="#" class='{ "color": "skyblue", "size": "large", "disable": true }'>revert</a>
			<a id="btnRemove" href="#" class='{ "color": "skyblue", "size": "large", "disable": true }'>remove</a>
			<a id="btnVal" href="#" class='{ "color": "skyblue", "size": "large", "disable": true }'>val</a>
			<a id="btnData" href="#" class='{ "color": "skyblue", "size": "large", "disable": true }'>data</a>
			<a id="btnValidate" href="#" class='{ "color": "skyblue", "size": "large", "disable": true }'>validate</a>
			<a id="btnReload" href="#" class='{ "color": "white", "size": "large" }'>Reload this page</a>
		</div>

		<p>Result : </p>
		<table id="grid" class="grid__">
			<thead>
				<tr>
					<th width="100" rowspan="2">picture</th>
					<th width="100">eyeColor</th>
					<th width="200">name</th>
					<th width="*">company</th>
					<th width="100">gender</th>
				</tr>
				<tr>
					<th>index</th>
					<th>age</th>
					<th>email</th>
					<th>isActive</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align="center" rowspan="2"><img id="picture" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D" height="32" /></td>
					<td><input id="eyeColor" type="text" /></td>
					<td id="name"></td>
					<td><input id="company" type="text" /></td>
					<td id="gender" align="center"></td>
				</tr>
				<tr>
					<td id="index" align="center"></td>
					<td><input id="age" type="text" class='{ "validate" : [["required"], ["integer"]] }' /></td>
					<td><input id="email" type="text" class='{ "validate" : [["required"], ["email"]] }' /></td>
					<td align="center"><input id="isActive" type="checkbox" /></td>
				</tr>
			</tbody>
		</table>
	</div>

	<div class="divBar">SOURCE CODE</div>
	<div class="sourceBox">
	</div>
</div>

<script type="text/javascript">

N("div#gridEx").cont({
	grid : undefined,
	gridData : undefined,
    init : function(view, request) {
    	// put source code
    	IndexController.getSourceCode(request.get("url"), N("div.sourceBox"));

    	this.initButton(view);

    	this.setEvents(view, this);
    },
    initButton : function(view) {
    	N("div.btnBox", view).button();
    },
    setEvents : function(view, this_) {
    	var grid;
    	N("a#btnInit").click(function(e) {
            e.preventDefault();
       		var opts = {
       			context : N("input#context", view).val(),
       			height : parseInt(N.string.trimToZero(N("input#height", view).val())),
       			validate : N("input#validate", view).is(":checked"),
       			html : N("input#html", view).is(":checked"),
       			addTop : N("input#addTop", view).is(":checked"),
       			resizable : N("input#resizable", view).is(":checked"),
       			vResizable : N("input#vResizable", view).is(":checked"),
       			sortable : N("input#sortable", view).is(":checked"),
       			select : N("input#select", view).is(":checked"),
       			multiselect : N("input#multiselect", view).is(":checked"),
       			hover : N("input#hover", view).is(":checked"),
       			createRowDelay : N.string.trimToNull(N("input#createRowDelay", view).val()) !== null ?
       				parseInt(N("input#createRowDelay", view).val()) : 1,
       			scrollPaging : {
       				size : N.string.trimToNull(N("input#scrollPagingSize", view).val()) !== null ?
       					parseInt(N("input#scrollPagingSize", view).val()) : 100
       			},
       			rowHandler : N.string.trimToNull(N("textarea#rowHandler", view).val()) !== null ?
       				eval("(" + N("textarea#rowHandler", view).val() + ")") : null,
    				onSelect : N.string.trimToNull(N("textarea#onSelect", view).val()) !== null ?
        				eval("(" + N("textarea#onSelect", view).val() + ")") : null,
        			onBind : N.string.trimToNull(N("textarea#onBind", view).val()) !== null ?
        				eval("(" + N("textarea#onBind", view).val() + ")") : null
       		}

       		grid = N([]).grid(opts).bind();

       		N("a#btnAdd", view).instance("button").enable();
            N("a#btnBind", view).instance("button").enable();
        });

    	N("a#btnAdd", view).click(function(e) {
            e.preventDefault();
        	grid.add();

        	N("div.btnBox", view).find("a").instance("button", function(u) {
            	if(!this.context().is("a#btnAdd") && !this.context().is("a#btnBind")) {
            		if(this.context().is("a#btnInit")) {
    					this.disable();
    				} else {
    					this.enable();
    				}
            	}
			});
        });

    	N("a#btnBind", view).click(function(e) {
            e.preventDefault();
            N.comm("prototype/data/grid.json").submit(function(data) {
            	grid.bind(data);
	       	});

            N("div.btnBox", view).find("a").instance("button", function(u) {
            	if(!this.context().is("a#btnAdd") && !this.context().is("a#btnBind")) {
            		if(this.context().is("a#btnInit")) {
    					this.disable();
    				} else {
    					this.enable();
    				}
            	}
			});
        });

    	N("a#btnRevert", view).click(function(e) {
            e.preventDefault();
       		grid.revert(N.string.trimToUndefined(N("input#rvtRow", view).val()));
        });

    	N("a#btnRemove", view).click(function(e) {
            e.preventDefault();
        	grid.remove(parseInt(N.string.trimToZero(N("input#rmvRow", view).val())));
        });

    	N("a#btnVal", view).click(function(e) {
            e.preventDefault();
            var row = N.string.trimToZero(N("input#row", view).val());
            var key = N.string.trimToNull(N("input#key", view).val());
            var value = N.string.trimToNull(N("input#val", view).val());
        	if(value !== null) {
        		grid.val(row, key, value);
        	} else {
        		grid.context().parent().alert(grid.val(row, key)).show();
        	}
        });

    	N("a#btnData", view).click(function(e) {
    		e.preventDefault();
    		grid.context().parent().alert({
        		msg : '<div class="pre">' + N.json.format(grid.data(N("select#data", view).val())) + '</div>',
        		width : 400,
        		height : 250
        	}).show();
        });

    	N("a#btnValidate", view).click(function(e) {
            e.preventDefault();
            grid.context().parent().alert(String(grid.validate())).show();
        });

    	N("a#btnReload", view).click(function(e) {
        	e.preventDefault();
        	N(view.parent()).comm(this_.request.get("url")).submit();
        });
    }
});

</script>